<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>HTML 版迷你 Excel</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Microsoft YaHei",sans-serif;margin:0;padding:1rem;background:#f7f7f7}
  h2{margin:.2em 0 .5em}#tb{border-collapse:collapse;width:100%;background:#fff;box-shadow:0 2px 6px rgba(0,0,0,.1)}
  #tb th,#tb td{border:1px solid #d0d0d0;padding:4px 6px;min-width:90px;height:28px}
  #tb th{background:#fafafa;text-align:center;font-weight:600}
  td input{border:0;outline:0;width:100%;padding:2px;font-size:14px}
  .btn{margin:.3rem .2rem;padding:6px 12px;border:0;border-radius:3px;background:#007bff;color:#fff;cursor:pointer}
  .btn:hover{background:#0056b3}
</style>
</head>
<body>
<h2>HTML 版迷你 Excel</h2>
<button class="btn" onclick="addRow()">增行</button>
<button class="btn" onclick="addCol()">增列</button>
<button class="btn" onclick="delRow()">删行</button>
<button class="btn" onclick="delCol()">删列</button>
<button class="btn" onclick="exportXlsx()">导出 .xlsx</button>

<table id="tb"></table>

<!-- 依赖：SheetJS 用于导出 -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script>
const cols=["A","B","C","D","E","F","G"];          // 初始列
let data=[["姓名","语文","数学","英语"],["张三",90,95,88],["李四",85,92,78]]; // 初始数据

function render(){
  const tb=document.getElementById('tb');
  tb.innerHTML="";
  // 表头
  const hRow=document.createElement('tr');
  hRow.innerHTML='<th></th>'+cols.map(c=>`<th>${c}</th>`).join('');
  tb.appendChild(hRow);
  // 数据行
  data.forEach((row,r)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<th>${r+1}</th>`+row.map((cell,c)=>{
      return`<td><input value="${cell}" onchange="data[${r}][${c}]=this.value"></td>`
    }).join('');
    tb.appendChild(tr);
  });
}
function addRow(){data.push(Array(cols.length).fill(""));render()}
function delRow(){if(data.length>1)data.pop();render()}
function addCol(){cols.push(String.fromCharCode(65+cols.length));data.forEach(r=>r.push(""));render()}
function delCol(){if(cols.length>1){cols.pop();data.forEach(r=>r.pop())}render()}

function exportXlsx(){
  const ws=XLSX.utils.aoa_to_sheet(data);
  const wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,ws,"Sheet1");
  XLSX.writeFile(wb,"HTML_Excel_导出.x
